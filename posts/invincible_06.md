# 阿森纳不败赛季射门探索 02: xG 特征

b 站刷到了一个 StatsBomb 的 xG 教学视频 [https://www.bilibili.com/video/BV13V4y1k77j](https://www.bilibili.com/video/BV13V4y1k77j), 更详细介绍了他们使用的 xG 特征，其视频后段也列了出来，重要的特征还标注了星标：

* **射门距离**
* **射门角度**
* 射门身体部位
* **射门是否来自定位球**
* **射门是否来自传中，什么类型的传中**
* 射门是否来自直塞球
* 射门是否来自完成盘带后
* **射门时接近的防守队员**
* 防守区域或者密度
* **射门与球门形成的三角形内球员人数**
* 守门员的位置
* 射门时球的高度

比起上一篇文章从他们的推特视频推断出的特征，多了一些射门前动作的判定。定位球需要单独的模型训练这个自不消说；射门前的动作，通过推进调整后的射门，球在脚下理论上射门难度是最低的；接到直塞球和完成盘带后球可能不会处在一个很舒服的位置；接到传中的射门最难，且球的高度越高越难以把握。

由于写这篇文章是在外地，身边的设备只有一台 iPad，不能获取到数据进行特征提取，也不能写代码，所以接下来的特征提取用探讨的方式，下次再补充代码。

首先是射门前的事件，在获取射门事件时通过 `id - 1` 可以得到。

查看之前写的文章 [不败赛季传球路线图探索 01](https://tanzhijian.org/posts/invincible01) 在 type_name 里有 'Dribbled Past', 'Dribble' ，可以获取到特征，射门是否来自完成盘带后。

直塞和传中，在 columns 里有 pass_cross，但没有直塞球 through，如果不能通过已有特征判定，则只能假设计算：传球与射门坐标连接的线，与射门的 y 轴形成的夹角小于 45 度，且最后射门类型为脚，则可以判定成直塞球，其余的均为传中，如下草图所示：

![through_ball.png](https://s2.loli.net/2023/05/20/4qnLOPTJ6jad5gB.png)

传中类型也通过最后的射门判定，用脚是低球传中，头球或其他则是高球传中。

射门部位在 StatsBomb 的公开数据里并没有球员的相关数据，不然可以通过判定射门时用脚和球员惯用脚是否为逆足，来获得更加准确的特征。

而防守区域或者密度，在视频里解释为不仅仅是防守者，还有进攻者——他的队友在哪里，都是潜在的阻挡射门的球员。虽然我并不认同这是个有用的特征，但还是把它加进来。采取的方式为射门位置 x 轴之后的球员均为防守区域的人数。
